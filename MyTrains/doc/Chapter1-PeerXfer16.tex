\newpage
\section{PeerXfer16}\index{PeerXfer16}

\underline{Description:}

This \gls{Command} sends the 8 bytes of data from one device to another peer to peer. This \gls{Command} takes many forms and so what is presented here is a generic description. The specific forms are included elsewhere as detailed messages in their own right.

\begin{tabular}{p{0.2\linewidth} p{0.1\linewidth} p{0.1\linewidth} p{0.50\linewidth}} 
\underline{SRC} & \underline{DSTL} & \underline{DSTH} & Comments\\
0x00 & & & Source is command station.\\
Don't Care & 0x00 & 0x00 & Broadcast Message.\\
0x70 to 0x7E & & & Reserved.\\
0x7F & 0x00 & 0x00 & Broadcast throttle message transfer.\\
0x7F & ID1 & ID2 & Throttle message transfer. ID1 and ID2 encode ID.\\
\end{tabular}

\underline{Protocol:}

1

\underline{Group:}

Variable-Byte Message

\underline{Opcode:}

OPC\_PEER\_XFER

\underline{Type:}

\gls{Command}

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 1 & 0 & 0 & 1 & 0 & 1\\
\hline
\end{tabular}
& 0xE5 & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x10 & Message length (16 bytes).\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$SRC$>$ & Source id in the range 0x00 to 0x7F.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$DSTL$>$ & Destination id low in the range 0x00 to 0x7F.\\
\end{tabular}

Byte 4:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$DSTH$>$ & Destination id high in the range 0x00 to 0x7F.\\
\end{tabular}

Byte 5:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & d6 & d5 & d4 & d3 & d2 & d1 & d0\\
\hline
\end{tabular}
& $<$PXCT1$>$ & Address type code and high bits of D1 to D4.\\
\end{tabular}

\begin{tabular}{p{0.05\linewidth} p{0.6\linewidth}} 
d6 & XC2. Address type code.\\
d5 & XC1. Address type code.\\
d4 & XC0. Address type code.\\
d3 & D4.7. High bit\\
d2 & D3.7. High bit\\
d1 & D2.7. High bit\\
d0 & D1.7. High bit\\
\end{tabular}

\begin{tabular}{p{0.1\linewidth} p{0.1\linewidth} p{0.1\linewidth} p{0.4\linewidth}} 
\underline{XC2} & \underline{XC1} & \underline{XC0} & \underline{Meaning}\\
0 & 0 & 0 & 7 bit peer to peer addresses.\\
0 & 0 & 1 & reserved.\\
0 & 1 & 0 & reserved.\\
0 & 1 & 1 & reserved.\\
1 & 0 & 0 & IPL download.\\
1 & 0 & 1 & reserved.\\
1 & 1 & 0 & reserved.\\
1 & 1 & 1 & reserved.\\
\end{tabular}

Byte 6:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D1$>$ & Data item 1. Low 7 bits.\\
\end{tabular}

Byte 7:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D2$>$ & Data item 2. Low 7 bits.\\
\end{tabular}

Byte 8:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D3$>$ & Data item 3. Low 7 bits.\\
\end{tabular}

Byte 9:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D4$>$ & Data item 4. Low 7 bits.\\
\end{tabular}

Byte 10:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$PXCT2$>$ & Data type code and high bits for D5 to D8.\\
\end{tabular}

\begin{tabular}{p{0.05\linewidth} p{0.91\linewidth}} 
d6 & XC5. Data type code.\\
d5 & XC4. Data type code.\\
d4 & XC3. Data type code.\\
d3 & D8.7. High bit\\
d2 & D7.7. High bit\\
d1 & D6.7. High bit\\
d0 & D5.7. High bit\\
\end{tabular}

\begin{tabular}{p{0.1\linewidth} p{0.1\linewidth} p{0.1\linewidth} p{0.6\linewidth}} 
\underline{XC5} & \underline{XC4} & \underline{XC3} & \underline{Meaning}\\
0 & 0 & 0 & ANSI text string. IPL download setup subcode.\\
0 & 0 & 1 & IPL download address subcode.\\
0 & 1 & 0 & IPL download send data subcode.\\
0 & 1 & 1 & IPL download verify data subcode.\\
1 & 0 & 0 & IPL download end of operation subcode.\\
1 & 0 & 1 & reserved.\\
1 & 1 & 0 & reserved.\\
1 & 1 & 1 & reserved.\\
\end{tabular}

Options flags
\begin{verbatim}
private static final int DO_NOT_CHECK_SOFTWARE_VERSION = 0x00;
    private static final int CHECK_SOFTWARE_VERSION_LESS = 0x04;

    private static final int DO_NOT_CHECK_HARDWARE_VERSION = 0x00;
    private static final int REQUIRE_HARDWARE_VERSION_EXACT_MATCH = 0x01;
    private static final int ACCEPT_LATER_HARDWARE_VERSIONS = 0x03;
\end{verbatim}

Byte 11:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D5$>$ & Data item 5. Low 7 bits.\\
\end{tabular}

Byte 12:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D6$>$ & Data item 6. Low 7 bits.\\
\end{tabular}

Byte 13:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D7$>$ & Data item 7. Low 7 bits.\\
\end{tabular}

Byte 14:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$D8$>$ & Data item 8. Low 7 bits.\\
\end{tabular}

Byte 15:

\begin{tabular}{p{0.4\linewidth} p{0.1\linewidth} p{0.5\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CHK$>$ & Checksum.\\
\end{tabular}

\underline{Response:} 

None

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 1 & 0 & 0 & 1 & 0 & 1\\
\hline
\end{tabular}
& 0xE5 \\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x10 \\
\end{tabular}

\underline{Notes:} 

None.

\rule{15.1cm}{0.4pt}
