\newpage
\subsection{GetLocoSlotDataSAdrP1}

\rule{15.1cm}{0.4pt}

\underline{Description:}

This command requests the slot number for the selected locomotive address. If the locomotive is found in the slot table then the command station returns an \textbf{LocoSlotDataP1} message with the slot information. If it is not found then the command station will put the locomotive into a free slot and then return an \textbf{LocoSlotDataP1} message with the slot information. If there are no free slots then the command station returns an \textbf{Ack} containing a response code.

The command station will generate NMRA 7 bit or short address packets for the locomotive. The address has the range 0 to 127. The analog locomotive is selected with address 0.  

\underline{Protocol:}

1

\underline{Group:} 

4-Byte Message

\underline{Opcode:}

OPC\_LOCO\_ADR

\underline{Type:}

Command

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 0 & 1 & 1 & 1 & 1 & 1 & 1\\
\hline
\end{tabular}
& 0xBF & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 &\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$ADR$>$ & Short address in the range 0 to 127.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CHK$>$ & Checksum.

\end{tabular}

\underline{Response:} 

\textbf{LocoSlotDataP1} if success, otherwise 

\textbf{Ack}

\begin{tabular}{p{0.10\linewidth} p{0.10\linewidth} p{0.40\linewidth}}
\underline{$<$LOPC$>$} & \underline{$<$ACK1$>$} & \underline{Meaning}\\
0x3F & 0x00 & No free slot, command failed.\\
\end{tabular}

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 0 & 1 & 1 & 1 & 1 & 1 & 1\\
\hline
\end{tabular}
& 0xBF\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 \\
\end{tabular}

\underline{Notes:} 

None.

\rule{15.1cm}{0.4pt}
