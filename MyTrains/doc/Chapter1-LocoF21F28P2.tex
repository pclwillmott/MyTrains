\newpage
\subsection{LocoF21F28P2}\index{LocoF21F28P2}\index{Functions}

\underline{Description:}

This command sets the locomotive's function F21 to F28 states.

\underline{Protocol:}

2

\underline{Group:}

6-Byte Message

\underline{Opcode:}

OPC\_D5\_GROUP (unofficial mnemonic)

\underline{Type:}

Command

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 0 & 1 & 0 & 1 & 0 & 1\\
\hline
\end{tabular}
& 0xD5 & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 1 & d4 & d3 & d2 & d1 & d0\\
\hline
\end{tabular}
& $<$SLOTP$>$ & Bits d2 to d0 contain the slot page number in the range 0x0 to 0x7. d4 and d3 encode the F28 state where 0b10 means on and 0b01 means off.\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$SLOT\#$>$ & Slot number in the range 0x00 to 0x77.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
&  & Low byte of \gls{Throttle ID}.\\
\end{tabular}

Byte 4:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & d6 & d5 & d4 & d3 & d2 & d1 & d0\\
\hline
\end{tabular}
&  & Function states.\\
\end{tabular}

\begin{tabular}{p{0.05\linewidth} p{0.95\linewidth}} 
d6 & F27 state: 1 means on and 0 means off.\\
d5 & F26 state: 1 means on and 0 means off.\\
d4 & F25 state: 1 means on and 0 means off.\\
d3 & F24 state: 1 means on and 0 means off.\\
d2 & F23 state: 1 means on and 0 means off.\\
d1 & F22 state: 1 means on and 0 means off.\\
d0 & F21 state: 1 means on and 0 means off.\\
\end{tabular}

Byte 5:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CHK$>$ & Checksum.\\
\end{tabular}

\underline{Response:} 

None.

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 0 & 1 & 0 & 1 & 0 & 1\\
\hline
\end{tabular}
& 0xD5 \\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth}  p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 1 & d4 & d3 & $\times$ & $\times$ & $\times$\\
\hline
\end{tabular}
& d4 and d3 can be 0b10 or 0b01\\ 
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& less than 0x78\\
\end{tabular}

\underline{Notes:} 

None.

\rule{15.1cm}{0.4pt}
