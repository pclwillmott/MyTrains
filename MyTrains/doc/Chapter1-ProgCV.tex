
\newpage
\section{ProgCV}\index{ProgCV}\index{Configuration Variables}\index{Programming}

\rule{15.1cm}{0.4pt}

\underline{Description:}

The \textbf{ProgCV} \gls{Command} is used to read and write a locomotive's mobile decoder configuration variables.

\underline{Group:}

Variable-Byte Message

\underline{Opcode:}

OPC\_WR\_SL\_DATA

\underline{Type:}

\gls{Command}

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 1 & 0 & 1 & 1 & 1 & 1\\
\hline
\end{tabular}
& 0xEF & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 1 & 1 & 1 & 0\\
\hline
\end{tabular}
& 0x0E & Message length.\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 1 & 1 & 1 & 1 & 1 & 0 & 0\\
\hline
\end{tabular}
& 0x7C & Programming slot number.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & d6 & d5 & d4 & d3 & d2 & d1 & d0\\
\hline
\end{tabular}
& $<$PCMD$>$ & Programming command.\\
\end{tabular}

\begin{tabular}{l l}
d6 & 0 means read and 1 means write\\
d5 & 1 means byte mode and 0 means bit mode\\
d4 & TY1\\
d3 & TY0\\
d2 & 0 means service mode on programming track, 1 means operations mode on mainline.\\
d1 & 1 - unknown\\
d0 & 1 - unknown\\
\end{tabular}

\begin{tabular}{p{0.05\linewidth}p{0.05\linewidth}p{0.05\linewidth}p{0.05\linewidth}p{0.05\linewidth}p{0.05\linewidth}p{0.515\linewidth}}
\underline{d5} & \underline{d4} & \underline{d3} & \underline{d2} & \underline{d1} & \underline{d0} & \underline{Programming Mode}\\
1 & 0 & 0 & 0 & $\times$ & $\times$ & \gls{Paged Mode} byte read/write on the \gls{Programming Track}\\
1 & 0 & 1 & 0 & $\times$ & $\times$ &  \gls{Direct Mode} byte read/write on the \gls{Programming Track}\\
0 & 0 & 1 & 0 & $\times$ & $\times$ &  \gls{Direct Mode} bit read/write on the \gls{Programming Track}\\
$\times$ & 1 & 0 & 0 & $\times$ & $\times$ &  \gls{Physical Register Mode} byte read/write on the \gls{Programming Track}\\
$\times$ & 1 & 1 & 0 & $\times$ & $\times$ &  Service track reserved function\\
1 &  0 & 0 & 1 & $\times$ & $\times$ &  \gls{Operations Mode} byte program on mainline no feedback\\
1 &  0 & 1 & 1 & $\times$ & $\times$ &  \gls{Operations Mode} byte program on mainline with feedback\\
0 &  0 & 0 & 1 & $\times$ & $\times$ &  \gls{Operations Mode} bit program on mainline no feedback\\
0 &  0 & 1 & 1 & $\times$ & $\times$ &  \gls{Operations Mode} program on mainline with feedback\\
\end{tabular}

Byte 4:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 & \\
\end{tabular}

Byte 5:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$HOPSA$>$ & In \gls{Operations Mode} programming this contains the 7 high address bits of the locomotive to program. 0x00 if service mode.\\
\end{tabular}

Byte 6:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$LOPSA$>$ & In \gls{Operations Mode} programming this contains the 7 low address bits of the locomotive to program. 0x00 if service mode.\\
\end{tabular}

Byte 7:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 & \\
\end{tabular}

Byte 8:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & d5 & d4 & 0 & 0 & d1 & d0\\
\hline
\end{tabular}
& $<$CVH$>$ & Configuration Variable number high 3 bits and most significant bit of data byte.\\
\end{tabular}

\begin{tabular}{l l}
d5 & CV9\\
d4 & CV8\\
d1 & DATA7\\
d0 & CV7\\
\end{tabular}

Byte 9:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CVH$>$ & Configuration Variable number low 7 bits. CV1 is 0x0000, CV2 is 0x0001 etc.\\
\end{tabular}

Byte 10:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$DATA$>$ & Data value low 7 bits.\\
\end{tabular}

Byte 11:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$SNH$>$ & Throttle ID low 7 bits of low byte.\\
\end{tabular}

Byte 12:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$SNL$>$ & Throttle ID low 7 bits of high byte.\\
\end{tabular}

Byte 13:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 1 & 1 & 1 & 1 & 1 & 1 & 0\\
\hline
\end{tabular}
& 0x7E & Checksum.\\
\end{tabular}

\underline{Response:} 

\textbf{Ack} and if command is accepted a \textbf{ProgSlotData} message

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 1 & 0 & 1 & 1 & 1 & 1\\
\hline
\end{tabular}
& 0xEF\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 1 & 1 & 1 & 0\\
\hline
\end{tabular}
& 0x0E & \\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 1 & 1 & 1 & 1 & 1 & 0 & 0\\
\hline
\end{tabular}
& 0x7C & \\
\end{tabular}

Byte 4:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 & \\
\end{tabular}

Byte 7:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline
\end{tabular}
& 0x00 & \\
\end{tabular}

Byte 8:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & $\times$ & $\times$ & 0 & 0 & $\times$ & $\times$\\
\hline
\end{tabular}
& \\
\end{tabular}

\underline{Notes:} 

None.

\rule{15.1cm}{0.4pt}

