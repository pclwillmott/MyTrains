\newpage
\section{LocoF21F27P2}\index{LocoF21F27P2}\index{Functions}

\underline{Description:}

This \gls{Command} requests the command station to set the locomotive's function F21 to F27 states.

\underline{Protocol:}

2

\underline{Group:}

6-Byte Message

\underline{Opcode:}

OPC\_D4\_GROUP (unofficial mnemonic)

\underline{Type:}

\gls{Command}

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 0 & 1 & 0 & 1 & 0 & 0\\
\hline
\end{tabular}
& 0xD4 & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 1 & 0 & 0 & d2 & d1 & d0\\
\hline
\end{tabular}
& $<$SLOTP$>$ & Bits d2 to d0 contain the slot page number in the range 0x0 to 0x7.\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$SLOT\#$>$ & Slot number.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 0 & 1 & 0 & 1\\
\hline
\end{tabular}
& 0x09 & Subcode.\\
\end{tabular}

Byte 4:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & d6 & d5 & d4 & d3 & d2 & d1 & d0\\
\hline
\end{tabular}
&  & Function states.\\
\end{tabular}

\begin{tabular}{p{0.05\linewidth} p{0.95\linewidth}} 
d6 & F27 state: 1 means on and 0 means off.\\
d5 & F26 state: 1 means on and 0 means off.\\
d4 & F25 state: 1 means on and 0 means off.\\
d3 & F24 state: 1 means on and 0 means off.\\
d2 & F23 state: 1 means on and 0 means off.\\
d1 & F22 state: 1 means on and 0 means off.\\
d0 & F21 state: 1 means on and 0 means off.\\
\end{tabular}

Byte 5:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CHK$>$ & Checksum.\\
\end{tabular}

\underline{Response:} 

None.

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 1 & 0 & 1 & 0 & 1 & 0 & 0\\
\hline
\end{tabular}
& 0xD4\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 1 & 0 & 0 & $\times$ & $\times$ & $\times$\\
\hline
\end{tabular}
& \\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & 0 & 0 & 0 & 1 & 0 & 0 & 1\\
\hline
\end{tabular}
& 0x09\\
\end{tabular}

\underline{Notes:} 

This command was identified in the output from the iTrain commercial model railway control application. It has not been made to work outside of the original context. It is included in this manual as the ``missing link" information that enables it to function may be found in the future. Until that time use the D5 Group commands for protocol 2 control.

\rule{15.1cm}{0.4pt}
