\newpage
\section{GetLocoSlotDataLAdrP2}\index{GetLocoSlotDataLAdrP2}

\rule{15.1cm}{0.4pt}

\underline{Description:}

This \gls{Command} requests a slot\index{Slot} for the selected locomotive \gls{address}. If the locomotive address is found in the slot table then the command station returns a \textbf{LocoSlotDataP2} \gls{Response} with the slot information. If it is not found then the command station will put the locomotive address into a \gls{Free} slot and then return an \textbf{LocoSlotDataP2} \gls{Response} with the slot information. If there are no free slots then the command station returns a \textbf{NoFreeSlotsP2} \gls{Response}.

The command station will generate \gls{NMRA} 14 bit or long address packets for the locomotive. The \gls{address} must be in the range 128 to 9983.

\underline{Protocol:}

2

\underline{Group:} 

4-Byte Message

\underline{Opcode:}

OPC\_LOCO\_ADR\_P2 (unofficial mnemonic)

\underline{Type:}

\gls{Command}

\underline{Encoding:} 

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 0 & 1 & 1 & 1 & 1 & 1 & 0\\
\hline
\end{tabular}
& 0xBE & Opcode.\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$ADR2$>$ & Address high 7 bits.\\
\end{tabular}

Byte 2:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$ADR$>$ & Address low 7 bits.\\
\end{tabular}

Byte 3:

\begin{tabular}{p{0.4\linewidth} p{0.15\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& $<$CHK$>$ & Checksum.\\

\end{tabular}

\underline{Response:} 

\textbf{LocoSlotDataP2} if success, otherwise \textbf{NoFreeSlotsP2}.

\underline{Signature:}

Byte 0:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
1 & 0 & 1 & 1 & 1 & 1 & 1 & 0\\
\hline
\end{tabular}
& 0xBE\\
\end{tabular}

Byte 1:

\begin{tabular}{p{0.4\linewidth} p{0.38\linewidth}} 

\begin{tabular}{|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|p{0.3cm}|}
\hline
0 & n & n & n & n & n & n & n\\
\hline
\end{tabular}
& not equal to 0\\
\end{tabular}

\underline{Notes:} 

This \gls{Command} can be disabled by the command station OpSw66.

\rule{15.1cm}{0.4pt}
